modelVersion: 4.0.0

parent: 
  groupId: io.skullabs.boilerplates
  artifactId: java-8
  version: 1.0.0

groupId: io.skullabs.kos
artifactId: kos-parent
version: 0.2.0
packaging: pom

properties:
  # VERSIONS
  version.vertx: 3.8.4
  version.injector: 1.2.0
  version.mockito: 2.28.2
  version.kotlin: 1.3.31
  version.lombok: 1.18.8
  version.slf4j: 1.7.9
  version.google-truth: 0.30
  version.compile-testing: "0.18"
  version.class-generator: "0.3.0"
  version.jacoco: "0.8.5"
  
  # CONFIGS
  sonar.jacoco.reportPaths: "${project.basedir}/../report/output/aggregated.exec"
  sonar.language: java
  sonar.java.coveragePlugin: jacoco

modules:
  - kos-core
  - kos-injector
  - kos-config-yaml
  - kos-annotations
  - kos-logging-slf4j
  - kos-bom
  - report 

# Pre-configured dependencies
dependencyManagement:
  dependencies:
    - { groupId: "${project.groupId}", version: "${project.version}", artifactId: kos-core }
    - { groupId: "${project.groupId}", version: "${project.version}", artifactId: kos-annotations }
    - { groupId: "${project.groupId}", version: "${project.version}", artifactId: kos-config-yaml }
    - { groupId: "${project.groupId}", version: "${project.version}", artifactId: kos-injector }
    - { groupId: "${project.groupId}", version: "${project.version}", artifactId: kos-logging-slf4j }

    # Mockito
    - { groupId: org.mockito,version: "${version.mockito}", scope: test, artifactId: mockito-core }
    - { groupId: org.mockito,version: "${version.mockito}", scope: test, artifactId: mockito-junit-jupiter }

    # Other minor dependencies
    - { groupId: io.skullabs.injector, version: "${version.injector}", artifactId: injector-core }
    - { groupId: io.skullabs.injector, version: "${version.injector}", artifactId: injector-processor, scope: provided }
    - { groupId: io.skullabs.apt, artifactId: class-generator, version: "${version.class-generator}" }
    - { groupId: com.google.truth, artifactId: truth, version: "${version.google-truth}", scope: test }
    - { groupId: com.google.testing.compile, artifactId: compile-testing, version: "${version.compile-testing}", scope: test }
    - { groupId: org.slf4j, artifactId: slf4j-api, version: "${version.slf4j}" }

    # Kotlin
    - { groupId: org.jetbrains.kotlin, version: "${version.kotlin}", artifactId: kotlin-stdlib }

    # Vert.X
    - groupId: io.vertx
      artifactId: vertx-stack-depchain
      version: "${version.vertx}"
      type: pom
      scope: import

build:
  pluginManagement:
    plugins:

      - groupId: org.jacoco
        version: "${version.jacoco}"
        artifactId: jacoco-maven-plugin

      - artifactId: maven-javadoc-plugin
        version: 3.1.0
        configuration:
          additionalJOptions:
            - "-Xdoclint:none"
          excludePackageNames: "kos.apt:kos.core.client"
          source: "8"

  plugins:
    - groupId: org.jacoco
      artifactId: jacoco-maven-plugin
      executions:
        - id: prepare-agent
          phase: validate
          goals: ["prepare-agent"]
          configuration:
            append: true
      configuration:
        rules:
          - element: BUNDLE
            excludes: [ "*Test" ]
            limits:
              - { counter: COMPLEXITY, value: COVEREDRATIO, minimum: "61%" }
              - { counter: LINE, value: COVEREDRATIO, minimum: "70%" }
        #dataFile: "${sonar.jacoco.reportPaths}"
        destFile: "${sonar.jacoco.reportPaths}"
