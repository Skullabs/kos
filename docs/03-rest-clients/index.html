
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Zero-overhead and minimalist web framework for Vert.x">
      
      
      
        <meta name="author" content="Skullabs Contributors">
      
      
        <link rel="canonical" href="https://skullabs.github.io/kos/03-rest-clients/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>Rest Clients - Kos</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../theme.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="blue-grey">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rest-clients" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kos" class="md-header__button md-logo" aria-label="Kos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rest Clients
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/skullabs/kos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kos" class="md-nav__button md-logo" aria-label="Kos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Kos
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/skullabs/kos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../01-getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../02-rest-apis/" class="md-nav__link">
        Rest APIs
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Rest Clients
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Rest Clients
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interfaces-as-api-entrypoints" class="md-nav__link">
    Interfaces as API entrypoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-responses-to-the-http-server" class="md-nav__link">
    Consuming responses to the Http Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instantiating-your-rest-client" class="md-nav__link">
    Instantiating your Rest Client
  </a>
  
    <nav class="md-nav" aria-label="Instantiating your Rest Client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-dependency-injection" class="md-nav__link">
    Using Dependency Injection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-plain-code" class="md-nav__link">
    Using plain code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../11-dependency-injection/" class="md-nav__link">
        Dependency Injection
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../21-kos-architecture/" class="md-nav__link">
        Kos Architecture Overview
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interfaces-as-api-entrypoints" class="md-nav__link">
    Interfaces as API entrypoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-responses-to-the-http-server" class="md-nav__link">
    Consuming responses to the Http Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instantiating-your-rest-client" class="md-nav__link">
    Instantiating your Rest Client
  </a>
  
    <nav class="md-nav" aria-label="Instantiating your Rest Client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-dependency-injection" class="md-nav__link">
    Using Dependency Injection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-plain-code" class="md-nav__link">
    Using plain code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/skullabs/kos/edit/master/docs_src/03-rest-clients.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="rest-clients">Rest Clients</h1>
<p>Write down rest clients is usually a task most people doesn't like to do,
specially in the JVM ecosystem. We have several Http abstractions and
implementations, each of them with different dependency stack. Vert.x team
introduced a web client API on their <code>vertx-web</code> module seamlessly integrated
with <code>vertx-core</code>, avoiding developers to face the so called dependency-hell.</p>
<p>By borrowing a few ideas from <a href="https://github.com/OpenFeign/feign">Netflix Feign</a>
and other known open source frameworks, Kos provides a simple API to create
Rest Clients that takes advantage of the well crafted <code>vertx-web</code> module. And,
if you've read the <a href="../02-rest-apis">Rest API</a> documentation, you'll notice that
Rest Clients also relies on <code>kos.rest.*</code> annotations being semantically similar
to its <a href="../02-rest-apis">Rest API</a>, so you only have to memorize a single set
of annotations.</p>
<p>It means:</p>
<ul>
<li>you can use the <a href="../02-rest-apis/#exposing-methods-as-rest-endpoints">same annotations</a> to map endpoints to methods</li>
<li>the same applies to map <a href="../02-rest-apis/#path-parameters">path parameters</a>,
  <a href="../02-rest-apis/#query-parameters">query parameters</a>
  and <a href="../02-rest-apis/#http-headers">headers</a>
  to arguments</li>
<li>You can even use the same <a href="../02-rest-apis/#capturing-the-request-payload">Body annotation</a>
  to serialize and send request payloads</li>
</ul>
<h2 id="interfaces-as-api-entrypoints">Interfaces as API entrypoints</h2>
<p>The biggest difference though lies on the fact that you don't write concrete classes,
but interfaces to define your Rest Clients. You also have to annotate them with <code>kos.rest.RestClient</code>
instead of the <code>kos.core.RestApi</code> one.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Kotlin</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">kos.rest.*</span>

<span class="nd">@RestClient</span><span class="p">(</span><span class="s">&quot;/calc&quot;</span><span class="p">)</span>
<span class="kd">interface</span> <span class="nc">CalculatorApiClient</span> <span class="p">{</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/plus/:a/:b&quot;</span><span class="p">)</span>
    <span class="kd">fun</span> <span class="nf">plus</span><span class="p">(</span>
        <span class="nd">@Param</span> <span class="n">a</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span>
        <span class="nd">@Param</span> <span class="n">b</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="p">):</span> <span class="n">Future</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/minus/:a/:b&quot;</span><span class="p">)</span>
    <span class="kd">fun</span> <span class="nf">minus</span><span class="p">(</span>
        <span class="nd">@Param</span> <span class="n">a</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span>
        <span class="nd">@Param</span> <span class="n">b</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="p">):</span> <span class="n">Future</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">kos.rest.*</span><span class="p">;</span>

<span class="nd">@RestClient</span><span class="p">(</span><span class="s">&quot;/calc&quot;</span><span class="p">)</span>
<span class="kd">interface</span> <span class="nc">CalculatorApiClient</span> <span class="p">{</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/plus/:a/:b&quot;</span><span class="p">)</span>
    <span class="n">Future</span><span class="o">&lt;</span><span class="n">Int</span><span class="o">&gt;</span> <span class="nf">plus</span><span class="p">(</span>
        <span class="nd">@Param</span> <span class="n">Integer</span> <span class="n">a</span><span class="p">,</span>
        <span class="nd">@Param</span> <span class="n">Integer</span> <span class="n">b</span>
    <span class="p">);</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/minus/:a/:b&quot;</span><span class="p">)</span>
    <span class="n">Future</span><span class="o">&lt;</span><span class="n">Int</span><span class="o">&gt;</span> <span class="nf">minus</span><span class="p">(</span>
        <span class="nd">@Param</span> <span class="n">Integer</span> <span class="n">a</span><span class="p">,</span>
        <span class="nd">@Param</span> <span class="n">Integer</span> <span class="n">b</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
<h2 id="consuming-responses-to-the-http-server">Consuming responses to the Http Server</h2>
<p>Kos Rest API's will infer the response from the return type defined on your functions:</p>
<ul>
<li><code>void</code>: methods that doesn't return a value will make the call to the desired API in
  a fire-and-forget fashion, completely ignoring the response received by the server.</li>
<li><code>io.vertx.core.Future&lt;?&gt;</code>: Http Clients will hold the received response in a Future object
  allowing you to handle the response asynchronously on your first convenience.</li>
</ul>
<p>As you probably notice, Http Clients never blocks the event loop. It comes with a few
restrictions though:</p>
<ul>
<li>You have no automated mechanism to map failures into objects</li>
<li>In case of Http responses other than <code>2xx</code> an Exception (<code>UnexpectedRestClientResponse</code>)
  will be set as future Response allowing you to manually handle the unexpected behavior.</li>
</ul>
<h2 id="instantiating-your-rest-client">Instantiating your Rest Client</h2>
<p>Unlike Rest API's endpoints which are automatically deployed by Kos, Rest Clients
will only be instantiated when required by your source code. They are instantiated
by the <code>RestClientFactory.instantiate(RestClientConfiguration, T)</code> method.</p>
<p>Below we discuss how you can instantiate them either using or not dependency injection.
You're going to notice that in both cases we need a factory method to expose it to the
rest of the system. The big difference is how you can access the factory and the memory
consumption they have. For further details on how Dependency Injection works with Kos
please process to <a href="../11-dependency-injection">this topic</a>. </p>
<h3 id="using-dependency-injection">Using Dependency Injection</h3>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Kotlin</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">injector.*</span>
<span class="k">import</span> <span class="nn">kos.core.client.RestClientConfiguration</span>

<span class="nd">@Singleton</span>
<span class="kd">class</span> <span class="nc">CalculatorApiClientConfiguration</span><span class="p">(</span>
    <span class="kd">val</span> <span class="nv">restClientFactory</span><span class="p">:</span> <span class="n">RestClientFactory</span>
<span class="p">){</span>

    <span class="nd">@Produces</span>
    <span class="c1">// Note: for optimal performance you might consider lazy load the client</span>
    <span class="kd">fun</span> <span class="nf">produceClient</span><span class="p">():</span> <span class="n">CalculatorApiClient</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="nv">baseUrl</span> <span class="o">=</span> <span class="s">&quot;https://empty.url&quot;</span>
        <span class="kd">val</span> <span class="nv">restConf</span> <span class="o">=</span> <span class="n">RestClientConfiguration</span><span class="p">.</span><span class="na">withUrl</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">).</span><span class="na">build</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">restClientFactory</span><span class="p">.</span><span class="na">instantiate</span><span class="p">(</span><span class="n">restConf</span><span class="p">,</span> <span class="n">CalculatorApiClient</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@RestApi</span>
<span class="kd">class</span> <span class="nc">MyApi</span><span class="p">(</span><span class="kd">val</span> <span class="nv">calculator</span><span class="p">:</span> <span class="n">CalculatorApiClient</span><span class="p">)</span> <span class="p">{</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/calc/2/plus/2&quot;</span><span class="p">)</span>
    <span class="kd">fun</span> <span class="nf">calculateTwoPlusTwo</span><span class="p">()</span> <span class="o">=</span> <span class="n">calculator</span><span class="p">.</span><span class="na">plus</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">injector.*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">io.vertx.core.Future</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">kos.core.client.RestClientConfiguration</span><span class="p">;</span>

<span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CalculatorApiClientConfiguration</span> <span class="p">{</span>

    <span class="kd">final</span> <span class="n">RestClientFactory</span> <span class="n">restClientFactory</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">CalculatorApiClientConfiguration</span><span class="p">(</span><span class="n">RestClientFactory</span> <span class="n">restClientFactory</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">restClientFactory</span> <span class="o">=</span> <span class="n">restClientFactory</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Produces</span>
    <span class="c1">// Note: for optimal performance you might consider lazy load the client</span>
    <span class="kd">private</span> <span class="n">CalculatorApiClient</span> <span class="nf">produceClient</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">val</span> <span class="n">baseUrl</span> <span class="o">=</span> <span class="s">&quot;https://empty.url&quot;</span><span class="p">;</span>
        <span class="n">val</span> <span class="n">restConf</span> <span class="o">=</span> <span class="n">RestClientConfiguration</span><span class="p">.</span><span class="na">withUrl</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">restClientFactory</span><span class="p">.</span><span class="na">instantiate</span><span class="p">(</span><span class="n">restConf</span><span class="p">,</span> <span class="n">CalculatorApiClient</span><span class="p">.</span><span class="na">java</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@RestApi</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApi</span> <span class="p">{</span>

    <span class="kd">final</span> <span class="n">CalculatorApiClient</span> <span class="n">calculator</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">MyApi</span><span class="p">(</span><span class="n">CalculatorApiClient</span> <span class="n">calculator</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/calc/2/plus/2&quot;</span><span class="p">)</span>
    <span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">calculateTwoPlusTwo</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">calculator</span><span class="p">.</span><span class="na">plus</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
<h3 id="using-plain-code">Using plain code</h3>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Kotlin</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">kos.core.client.RestClientConfiguration</span>

<span class="kd">class</span> <span class="nc">CalculatorApiClientConfiguration</span> <span class="p">{</span>

    <span class="c1">// Note: for optimal performance please consider to use Kos.implementationLoader to instantiate it</span>
    <span class="kd">val</span> <span class="nv">restClientFactory</span> <span class="o">=</span> <span class="n">RestClientFactory</span><span class="p">();</span>

    <span class="c1">// Note: for optimal performance you might consider lazy load the client</span>
    <span class="kd">fun</span> <span class="nf">produceClient</span><span class="p">():</span> <span class="n">CalculatorApiClient</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="nv">baseUrl</span> <span class="o">=</span> <span class="s">&quot;https://empty.url&quot;</span>
        <span class="kd">val</span> <span class="nv">restConf</span> <span class="o">=</span> <span class="n">RestClientConfiguration</span><span class="p">.</span><span class="na">withUrl</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">).</span><span class="na">build</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">restClientFactory</span><span class="p">.</span><span class="na">instantiate</span><span class="p">(</span><span class="n">restConf</span><span class="p">,</span> <span class="n">CalculatorApiClient</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="nd">@RestApi</span>
<span class="kd">class</span> <span class="nc">MyApi</span> <span class="p">{</span>

    <span class="c1">// Note: for optimal performance please consider to use Kos.implementationLoader to instantiate it</span>
    <span class="kd">val</span> <span class="nv">calculator</span> <span class="o">=</span> <span class="n">CalculatorApiClientConfiguration</span><span class="p">().</span><span class="na">produceClient</span><span class="p">()</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/calc/2/plus/2&quot;</span><span class="p">)</span>
    <span class="kd">fun</span> <span class="nf">calculateTwoPlusTwo</span><span class="p">()</span> <span class="o">=</span> <span class="n">calculator</span><span class="p">.</span><span class="na">plus</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">io.vertx.core.Future</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">kos.core.client.RestClientConfiguration</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CalculatorApiClientConfiguration</span> <span class="p">{</span>

    <span class="c1">// Note: for optimal performance please consider to use Kos.implementationLoader to instantiate it</span>
    <span class="kd">final</span> <span class="n">RestClientFactory</span> <span class="n">restClientFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RestClientFactory</span><span class="p">();</span>

    <span class="c1">// Note: for optimal performance you might consider lazy load the client</span>
    <span class="kd">private</span> <span class="n">CalculatorApiClient</span> <span class="nf">produceClient</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">val</span> <span class="n">baseUrl</span> <span class="o">=</span> <span class="s">&quot;https://empty.url&quot;</span><span class="p">;</span>
        <span class="n">val</span> <span class="n">restConf</span> <span class="o">=</span> <span class="n">RestClientConfiguration</span><span class="p">.</span><span class="na">withUrl</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">restClientFactory</span><span class="p">.</span><span class="na">instantiate</span><span class="p">(</span><span class="n">restConf</span><span class="p">,</span> <span class="n">CalculatorApiClient</span><span class="p">.</span><span class="na">java</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@RestApi</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApi</span> <span class="p">{</span>

    <span class="kd">final</span> <span class="n">CalculatorApiClient</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CalculatorApiClientConfiguration</span><span class="p">().</span><span class="na">produceClient</span><span class="p">();</span>

    <span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/calc/2/plus/2&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Future</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">calculateTwoPlusTwo</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">calculator</span><span class="p">.</span><span class="na">plus</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../02-rest-apis/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Rest APIs" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Rest APIs
            </div>
          </div>
        </a>
      
      
        
        <a href="../11-dependency-injection/" class="md-footer__link md-footer__link--next" aria-label="Next: Dependency Injection" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Dependency Injection
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2020 Skullabs Contributors
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.82b56eb2.min.js"></script>
      
    
  </body>
</html>